
import React, { useState, useEffect } from 'react';
import { Button } from '@/components/ui/button';

interface ResultsProps {
  preferences: {
    mood: string;
    budget: string;
    duration: string;
    travelStyle: string;
  };
}

const Results: React.FC<ResultsProps> = ({ preferences }) => {
  const [isGenerating, setIsGenerating] = useState(true);
  const [generatedText, setGeneratedText] = useState('');
  const [currentTextLength, setCurrentTextLength] = useState(0);

  // Mock text that would be generated by Gemini 2.0 Flash
  const mockGeneratedText = `Based on your ${preferences.mood} mood, ${preferences.budget} budget, and preference for ${preferences.duration} trips with ${preferences.travelStyle} travel, I recommend the following itinerary:

Destination: Kyoto, Japan ðŸ‡¯ðŸ‡µ

Kyoto offers the perfect blend of tranquility and cultural richness that matches your mood. With its stunning temples, beautiful gardens, and authentic culinary experiences, it's ideal for a ${preferences.duration} getaway.

Day 1-2: Explore the historic Gion district and visit the iconic Fushimi Inari Shrine with its thousands of vermilion torii gates. Enjoy a traditional tea ceremony experience.

Day 3-4: Take a day trip to nearby Nara to see the friendly deer and impressive Todai-ji Temple. Return to Kyoto for an evening food tour through Pontocho Alley.

Day 5-7: Explore the bamboo forests of Arashiyama, visit the golden Kinkaku-ji Temple, and take a cooking class to learn authentic Japanese cuisine.

Accommodation options range from traditional ryokans to modern hotels that fit your ${preferences.budget} budget. The city is particularly beautiful during cherry blossom season (late March to early April) or autumn foliage (November).

Alternative Destination: The Amalfi Coast, Italy ðŸ‡®ðŸ‡¹

If you prefer something more Mediterranean, the Amalfi Coast offers stunning coastal views, charming villages, and excellent cuisine. Perfect for ${preferences.travelStyle} travel, you can explore Positano, Ravello, and take boat trips to nearby islands.`;

  // Simulate the text generation process
  useEffect(() => {
    if (isGenerating && currentTextLength < mockGeneratedText.length) {
      const timer = setTimeout(() => {
        setGeneratedText(mockGeneratedText.substring(0, currentTextLength + 3));
        setCurrentTextLength(prev => prev + 3);
      }, 10);
      return () => clearTimeout(timer);
    } else if (currentTextLength >= mockGeneratedText.length) {
      setIsGenerating(false);
    }
  }, [isGenerating, currentTextLength, mockGeneratedText]);

  return (
    <div className="w-full max-w-4xl mx-auto animate-fade-in">
      <div className="text-center mb-8">
        <h2 className="text-3xl font-bold mb-2">Your Personalized Journey</h2>
        <p className="text-gray-600">
          Based on your preferences, our AI has crafted the perfect travel experience for you.
        </p>
      </div>

      <div className="bg-white rounded-xl shadow-xl p-6 md:p-8 mb-8 relative overflow-hidden">
        <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-tour-purple to-tour-brightBlue"></div>
        
        {isGenerating && (
          <div className="flex items-center mb-4">
            <div className="animate-pulse h-3 w-3 rounded-full bg-tour-purple mr-2"></div>
            <p className="text-sm text-gray-500">Gemini 2.0 Flash is generating your personalized travel plan...</p>
          </div>
        )}
        
        <div className="prose max-w-none whitespace-pre-wrap">
          {generatedText.split('\n\n').map((paragraph, index) => (
            <p key={index} className={index === 0 ? "text-xl font-medium" : ""}>{paragraph}</p>
          ))}
        </div>
        
        {!isGenerating && (
          <div className="mt-8 flex flex-col sm:flex-row gap-4 justify-center">
            <Button className="bg-tour-purple hover:bg-tour-purple/80">
              Save This Plan
            </Button>
            <Button variant="outline">
              Regenerate Options
            </Button>
          </div>
        )}
      </div>
    </div>
  );
};

export default Results;
